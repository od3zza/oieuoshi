<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt" lang="pt-BR">
  <head>
    <meta charset="utf-8" />

    <title>A adaga - Poesias - Uoshi</title>

    <meta name="author" content="Uoshi" />
    <meta
      name="description"
      content="Parte da cole√ß√£o de poesias e pequenos textos."
    />
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="alternate" type="application/rss+xml" href="/sitemap.xml" />

    <!-- Manifest .json-->
    <link rel="manifest" href="/manifest.json" />

    <!-- Libs -->
    <link
      rel="stylesheet"
      href="/lib/style.css"
      type="text/css"
      media="screen, projection"
    />
    <script src="/lib/script.js" defer></script>

    <!-- Theme Color - https://goo.gl/qRE0vM -->
    <meta name="theme-color" content="#ffffff" />

    <!-- √çcone-->
    <link
      rel="icon"
      type="image/png"
      href="https://cdn.glitch.global/5d620f50-0e74-4257-aa4d-114f5d987ec5/favicon.png?v=1727965698348"
    />

    <!-- Abre Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-HZNDKKGKW8"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-HZNDKKGKW8");
    </script>
    <!-- Fecha Google tag (gtag.js) -->

    <!-- SSL Protocol Config -->
    <script>
      if (location.protocol != "https:") {
        location.href =
          "https:" +
          window.location.href.substring(window.location.protocol.length);
      }
    </script>
    <meta name="p:domain_verify" content="fd7d215910ea0cf1c785c7c7cf7a7c0f" />
    <!-- End SSL Protocol Config -->
  </head>

  <!--
          )      (\_
         ((    _/{  "-;
          )).-' {{ ;'`
HEY U!   ( (  ;._ \\      -->

  <body>
    <!-- Abre Header -->
    <!-- sidebar esquerdo -->
    <div class="container"></div>
    <header class="sidebar">
      <div class="sidebar-text">
        <nav class="sections">
          <ul>
            <a href="/blog">‚Üê blog</a>
          </ul>
        </nav>
      </div>
    </header>
    <!-- end sidebar -->

    <!-- Fecha Header -->

    <!-- Abre base -->
    <!-- <link rel="stylesheet" href="/css/scroller.css" type="text/css" media="screen, projection"/> -->
    <section class="main">
      <sub> Novembro, 2023 </sub>
      <!-- t√≠tulo -->
      <h1>A adaga</h1>

      <sub> poesias üìñ</sub>
      <br /><br />

      <!-- conte√∫do -->

      <p>
        Sua m√£o deslizou sobre minha face <br />Pele na pele, a excita√ß√£o
        transbordava<br />
        Del√≠rios intermin√°veis e imensur√°veis <br />Ela disse que aquilo era o
        amor.
      </p>

      <p>
        Seus l√°bios tocaram os meus, e desceram pelo meu pesco√ßo<br />
        Um calafrio correu pela minha espinha<br />
        E um suspiro longo marcou o momento.
      </p>
      <p>
        Meu corpo gelou ao ser mordido<br />
        E uma press√£o em meu peito me tirou da realidade <br />Com uma mistura
        amarga de dor e prazer, <br />Ent√£o ela se afastou...
      </p>
      <p>
        E deixou, al√©m do desejo, a sua adaga cravada em meu cora√ß√£o;
        <br />Banho de sangue.
      </p>
    <hr /> 

    <section class="comments-section">
        
        <div class="comments-form">
            <h3>Deixe seu coment√°rio</h3>
            <div id="message-area"></div>
            <form id="comment-form">
                <div class="form-group">
                    <label for="nome">Nome *</label>
                    <input type="text" id="nome" name="nome" required>
                </div>
                <div class="form-group">
                    <label for="link">Website/Link (opcional)</label>
                    <input type="url" id="link" name="link" placeholder="https://exemplo.com">
                </div>
                <div class="form-group">
                    <label for="comentario">Coment√°rio *</label>
                    <textarea id="comentario" name="comentario" required placeholder="Escreva seu coment√°rio aqui..."></textarea>
                </div>
                <button type="submit" class="btn-submit">Enviar Coment√°rio</button>
            </form>
        </div>
        
        <div class="comments-list">
            <h3>Coment√°rios</h3>
            <div id="comments-container">
                <div class="loading">Carregando coment√°rios...</div>
            </div>
        </div>
    </section>
<section class="footer">


  <div id="comments-section" class="comments-section">
        <!-- O conte√∫do ser√° inserido aqui via JavaScript -->
    </div>
  
</section>

 <script>
        class CommentsSystem {
            constructor(apiUrl, categoria, titulo) {
                this.apiUrl = apiUrl;
                this.categoria = categoria;
                this.titulo = titulo;
                this.container = document.getElementById('comments-section');
                
                this.init();
            }

            init() {
                this.renderHTML();
                this.attachEventListeners();
                this.loadComments();
            }

            renderHTML() {
                this.container.innerHTML = `
                    <h3 class="comments-title">Coment√°rios</h3>
                    
                    <form id="comment-form" class="comment-form">
                        <div class="form-group">
                            <label for="nome" class="form-label">Nome *</label>
                            <input type="text" id="nome" name="nome" class="form-input" required maxlength="100">
                        </div>
                        
                        <div class="form-group">
                            <label for="link" class="form-label">Website (opcional)</label>
                            <input type="url" id="link" name="link" class="form-input" placeholder="https://exemplo.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="comentario" class="form-label">Coment√°rio *</label>
                            <textarea id="comentario" name="comentario" class="form-input form-textarea" required maxlength="1000" placeholder="Escreva seu coment√°rio aqui..."></textarea>
                        </div>
                        
                        <button type="submit" class="submit-btn">Enviar Coment√°rio</button>
                    </form>

                    <div id="message-area"></div>
                    
                    <div id="comments-list" class="comments-list">
                        <div class="loading">Carregando coment√°rios...</div>
                    </div>
                `;
            }

            attachEventListeners() {
                const form = document.getElementById('comment-form');
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitComment();
                });
            }

            async loadComments() {
                try {
                    const response = await fetch(`${this.apiUrl}?categoria=${encodeURIComponent(this.categoria)}&titulo=${encodeURIComponent(this.titulo)}`);
                    const data = await response.json();
                    
                    if (data.success) {
                        this.renderComments(data.comments, data.total);
                    } else {
                        this.showError('Erro ao carregar coment√°rios');
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    this.showError('Erro ao conectar com o servidor');
                }
            }

            async submitComment() {
                const form = document.getElementById('comment-form');
                const submitBtn = form.querySelector('.submit-btn');
                const nome = document.getElementById('nome').value.trim();
                const link = document.getElementById('link').value.trim();
                const comentario = document.getElementById('comentario').value.trim();

                if (!nome || !comentario) {
                    this.showError('Por favor, preencha todos os campos obrigat√≥rios');
                    return;
                }

                submitBtn.disabled = true;
                submitBtn.textContent = 'Enviando...';

                try {
                    const response = await fetch(this.apiUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            categoria: this.categoria,
                            titulo: this.titulo,
                            nome: nome,
                            link: link,
                            comentario: comentario
                        })
                    });

                    const data = await response.json();

                    if (data.success) {
                        this.showSuccess('Coment√°rio enviado com sucesso!');
                        form.reset();
                        this.loadComments(); // Recarregar coment√°rios
                    } else {
                        this.showError(data.error || 'Erro ao enviar coment√°rio');
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    this.showError('Erro ao conectar com o servidor');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Enviar Coment√°rio';
                }
            }

            renderComments(comments, total) {
                const container = document.getElementById('comments-list');
                
                if (comments.length === 0) {
                    container.innerHTML = `
                        <div class="comments-count">0 coment√°rios</div>
                        <div class="no-comments">Seja o primeiro a comentar!</div>
                    `;
                    return;
                }

                // Ordenar coment√°rios por data (mais recentes primeiro)
                comments.sort((a, b) => b.timestamp - a.timestamp);

                let html = `<div class="comments-count">${total} coment√°rio${total !== 1 ? 's' : ''}</div>`;
                
                comments.forEach(comment => {
                    const data = new Date(comment.data).toLocaleString('pt-BR');
                    const autorLink = comment.link ? 
                        `<a href="${comment.link}" target="_blank" rel="noopener noreferrer" class="comment-author">${comment.nome}</a>` :
                        `<span class="comment-author">${comment.nome}</span>`;
                    
                    html += `
                        <div class="comment-item">
                            <div class="comment-header">
                                ${autorLink}
                                <span class="comment-date">${data}</span>
                            </div>
                            <div class="comment-text">${comment.comentario}</div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            showError(message) {
                const messageArea = document.getElementById('message-area');
                messageArea.innerHTML = `<div class="error-message">${message}</div>`;
                this.clearMessageAfterDelay();
            }

            showSuccess(message) {
                const messageArea = document.getElementById('message-area');
                messageArea.innerHTML = `<div class="success-message">${message}</div>`;
                this.clearMessageAfterDelay();
            }

            clearMessageAfterDelay() {
                setTimeout(() => {
                    const messageArea = document.getElementById('message-area');
                    messageArea.innerHTML = '';
                }, 5000);
            }
        }

        // Inicializar o sistema de coment√°rios
        // VOC√ä PRECISA CONFIGURAR ESTAS VARI√ÅVEIS:
        
        // URL da API PHP (ajuste conforme sua configura√ß√£o)
        const API_URL = 'lib/comments.php'; // ou 'https://seusite.com/comments.php'
        
        // Extrair categoria e t√≠tulo da URL atual
        // Assumindo URL formato: /blog/CATEGORIA/TITULO
        function extractFromUrl() {
            const path = window.location.pathname;
            const matches = path.match(/\/blog\/([^\/]+)\/([^\/]+)/);
            
            if (matches) {
                return {
                    categoria: decodeURIComponent(matches[1]),
                    titulo: decodeURIComponent(matches[2])
                };
            }
            
            // Fallback para teste
            return {
                categoria: 'tecnologia',
                titulo: 'exemplo-post'
            };
        }

        // Inicializar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', () => {
            const { categoria, titulo } = extractFromUrl();
            new CommentsSystem(API_URL, categoria, titulo);
        });
    </script>

      
  </body>
</html>
